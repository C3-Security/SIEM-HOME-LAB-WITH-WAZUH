# Setting up a SIEM Home lab using Wazuh
This project will be providing you with the necessary steps that I did to configure a Security Information &amp; Event (SIEM) home lab using Wazuh. Wazuh is a FREE open-source security platform that provides both XDR & SIEM protection. We'll be using Wazuh to monitor, detect, alert, & respond to threats generated by our virtual machines. While other tools such as Splunk are favored by most companies, Wazuh is completely free which is perfect for small businesses & home projects.

The purpose of this project is to acquire hands-on experience of using a XDR & SIEM tool to detect, analyze, & respond to threats that we'll be generating using Kali Linux & Windows. The great thing about this project is that we'll be able to gain experience in the realm of the Red Team & Blue Team since we'll be attacking our own network using Linux & then using Wazuh to detect, analyze, & respond to those generated threats. 

# Environments Used
- VMWare Workstation Pro 17 as the hypervisor but VirtualBox will work just as well.
- Ubuntu 22.04 as the server for Wazuh
- Windows & Linux as endpoint machines

# Configuring Wazuh on Ubuntu
In this project, we'll be using Ubuntu 22.04 as the server for Wazuh. If you don't already have a Ubuntu VM, you can check out the following youtube guides to set one up.
*insert youtube links*

Once you have your Ubuntu VM launched, we'll start by installing Wazuh.
You can follow this link for official documentation for Wazuh for installation: https://documentation.wazuh.com/current/quickstart.html

On the Ubuntu VM, we'll run the Wazuh installation assistant by opening Terminal and using the following command:
```
sudo curl -sO https://packages.wazuh.com/4.7/wazuh-install.sh && sudo bash ./wazuh-install.sh -a
```
 *(Installation may take around 5-10 minutes so try to be patient)*
![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/ce913306-da69-45a8-91b5-7ce78f22a5c4)

Once you run that command, it should begin the installation of Wazuh and then provide you with the username, password, and web interface link to login.
Open up a text file and save the username & password as you'll be needing that later on.

To figure out your wazuh-dashboard-ip, you can use the command ```ip a``` , which should provide you with the localhost IP to connect with

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/784fbd19-e1ca-4441-a38d-c2638f882b0f)

Go ahead and open up Firefox and you should be able to connect to your dashboard using the IP that you found using ```ip a```
It may prompt that the certifcate is untrusted, but go ahead & click on "Advanced", then "Accept the Risk and Continue"

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/aaa9913d-bd02-46c2-b4cc-08353a8dd0f5)

You should now be loaded on the Wazuh dashboard login screen. Using the credentials provided earlier, you should be able to login.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/880eb00a-f801-4932-bf69-a16373de9d1c)

Once logged in, you should be loaded onto the dashboard. On this dashboard you'll be able to see a few statistics such as the total & active agents that are on your Wazuh network. Now it's time to add some agents

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/0d850723-6c66-4321-8796-11bcf4109f17)

Before we can successfully add agents to the dashboard, we need to actually create agents/virtual machines. Using VMWare or VirtualBox, create another Ubuntu instance.
In VMWare, I was able to easily a copy of another Ubuntu VM
![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/87a697de-83a8-4598-9f72-ef3c3cbe3a00)


Once you have your 2nd VM created, head back to the Wazuh dashboard on the server and click the button "Add Agent". then you should be prompted with options for configuring the package for this specific agent.
For our first agent, we'll be configuring the Ubuntu 22.04 VM so let's select DEB amd64
For the server address, it'll the same IP address that you used to connect to the Wazuh dashboard

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/0eb00ce9-a8ab-4cff-a1a4-37af6bba046e)

You can also assign the agent a name if you'd like. I went ahead and named our agent: "Linux"

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/93dbffeb-7588-4e33-b442-c005a0df44b2)

Right below, you'll find the first command that you need to run on the Linux agent VM.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/dbf5a132-36bf-4ceb-afdb-f4851fced46b)

I went ahead and changed our Linux agent's terminal color to Tango dark so it's easier to differentiate between the VM's since we'll be going back and forth.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/878a62bf-4801-4da0-bbb2-b237ea1b220b)

Once that package is installed, head back to the Wazuh dashboard, copy the next set of commands, and paste it in the terminal of the Linux agent.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/3f49d544-9cc3-4bfa-b51c-fcb81ee38d5c)

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/aadc1f95-4dc8-49c3-8c02-862599d6b19b)

You can use the command ```sudo systemctl status wazuh-agent``` to verify if the agent service is active on the machine

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/c330b521-2e5e-4d7e-a52f-6468c8fb2591)


Once that's completed, you should now also be able to see the Linux agent on the Wazuh dashboard.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/84497ddb-1788-47c5-be24-55281087dd64)

Since adding agents is so simple and easy, let's go ahead and add another. For our next agent, we'll be using Windows 10. Once you have your Windows VM created, head back to the Wazuh Dashboard and select "deploy a new agent". The steps will be extremely similar to the first agent that we added. Select the configuration according to the next virtual machine that you're using. In this project, we're using Windows 10.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/4528dbd4-9c4a-467f-8152-5045d857eea2)

Once you've filled out the agent info, copy the following command and paste it in Windows Powershell using administrative privileges to start the installation of the Wazuh agent on the Windows VM.

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/e71d8bd2-e523-455f-a173-6b73a0e07b59)
![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/525cf85d-751e-4547-853c-00ac11dc00ff)

Once the installation of the Wazuh agent is finished on PS, run the command ```NET START WazuhSvc``` to start the agent

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/a04eb1fe-7ced-4f8a-b49b-d185263b936d)

Heading back to the Wazuh dashboard, you should now  have 2 active agents & an active SIEM to start your home lab analysis

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/c08d9372-60ac-4c26-8cbb-d762f4968b6e)

![image](https://github.com/C3-Security/SIEM-HOME-LAB-WITH-WAZUH/assets/167286637/f2fc9068-dbd2-4dd7-9d07-771aedae4679)































